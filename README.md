#Краткое описание
Сбор данных по WB api и запись в google sheets

#Описание проекта
1)В 8 утра по Москве (Можно поменять время) начинается работа.
2)В папке google drive фильтруются по ключевому слову и собираются таблицы.
3)Работа с каждой таблицей по очереди:
	1)Получение и запись в лист "оборачиваемости"
	2)Копирование данных из листа оборачиваемости и запись в отдельный сводный лист в другой таблице
	3)Получение и запись данных в лист "РНП"
4)Копирование и запись всех сводных листов в общий сводный лист

Все данные берутся за прошедший день с 00:00:00 до 23:59:59
Данные по остакам на складах выгружаются только текущие, за прошедшние дни не получить
В листах с оборачиваемостью, каждое второе число данные вырезаются и записываются правее от основной таблицы, для сравнения статистики с прошедшим месяцем
В листах РНП автоматически добавляются столбцы, когда начинается новый месяц

#Данные хранящиеся в таблицах
1)Лист "оборачиваемость":
	1)Артикул
	2)Остатки на складах
	3)Продажи в день каждого артикула
	4)Общие продажи за день
	5)Общие продажи по артикулу за месяц
	6)Средние продажи по артикулу за 3, 7 и 21 день
	7)Данные за прошедший месяц
2)Лист "РНП":
	1)Рейтинг
	2)Маржинальная прибыль, руб
	3)Маржа, %
	4)Заказы, руб
	5)Средний чек без СПП, руб
	6)СПП, %
	7)Общий трафик, клики
	8)Корзины, шт
	9)Заказы, шт
	10)Показы, шт
	11)Клики с РК, шт
	12)Расход РК, руб
	13)ДРР, %
	14) CTR, %
	15)Конверсия в корзину, %
	16)Конверсия в заказ, %
	17)Оборачиваемость, дни
	18)Общий остаток FBO, шт
	19)Остаток на складах: Центр, Питер, Казань, Юг, Урал, Сибирь
	20)В пути к клиенту, шт
	21)В пути от клиента, шт
	22)Артикул
	23)Название таблицы
	24)Общие значения за день всех артикулов
	25)Общие значения за неделю/месяц по артикулу
	26)Общие значения за неделю/месяц по всем артикулам
3)Сводная таблица:
	1)Сводные данные по каждому продавцу
	2)Сводные данные по всем продавцам (Копия всех сводных в один лист)
	
#Данные необходимые для работы скрипта
1)Id папки с таблицами
2)Id сводной таблицы
3)Слово по которому будет фильтрация таблиц, это слово должно быть в начале названия каждой таблицы с которой будет работа
4)GoogleCreditionals.json
5)В каждой продавца таблице в листе "Оборачиваемость" в ячейке A1 должен находится wb api-key

#Где взять необходимые данные для работы скрипты
1)Id папки берется из конца ссылки на неё - https://drive.google.com/drive/folders/{GoogleDriveFolderId}
2)Id сводной таблицы берется из ссылки на неё, он находится между /d/ и /edit - https://docs.google.com/spreadsheets/d/{SummarySpreadsheetId}/edit?gid=19967736#gid=19967736
3)Нужно решить какое слово будет для фильтрации
4)Получение GoogleCreditionals.json
	1)Заходим и регисрируемся на https://console.cloud.google.com/welcome?inv=1&invt=AbyIig&project=wbapi-451306
	2)Нажимаем select project, new project, выбираем имя и нажимаем create
	3)Выбираем наш проект, если не выбрался автоматически
	4)Нажимаем на три полоски слева сверху и выбираем APIs & Services -> library
	5)В library ищем сначала Google Sheets API, выбираем его и нажимаем enable, а затем Google Drive API, выбираем и нажимаем enable
	6)Дальше заходим в IAM & Admin -> Service accounts -> Create service account
	7)Вводим имя, остальное по желанию, нажимаем done
	8)в service aocount появится только что созданный аккаунт, нажиаем на него
	9)Keys -> add key -> create new key -> json -> create, автоматически скачается GoogleCreditionals.json
5)Зайти в wbpartners, перейти к настройкам кабинета -> доступ к api -> создать токен, для работы нужен токен со следующими разрешениями: Продвижение, аналитика, вопросы и отзывы, статистика, цены и скидки

#Важные детали при работе
Нарушение указаных ниже правил может привести к неккоректной работе или ошибкам
1)Для работы скрипта нужно добавить его, как редактора в таблицы и папку с этими таблицами
2)В таблицах нельзя объединять/разъединять ячейки
3)Если какой-то ключ отключен или продавец больше не работает, нужно удалить ключ из таблицы (Находится в листе "Оборачиваемость" в ячейке A1)
4)Таблицы, а также листы в сводной таблице кабинетов с которыми уже не работаем удалять нужно вручную
5)Изменение форматирования (Цвет ячеек, размер ячеек, цвет текста, размер текста и т.д) в ячейках которые будут менятся скриптом, будут затираться, форматирование ячеек которые не будут менятся (Например, данные за прошедшие даты в РНП) не будут затираться