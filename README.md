# WB Analytics Automation

Скрипт автоматизирует сбор и обработку данных по Wildberries API, ежедневно обновляя Google Таблицы с показателями оборачиваемости и РНП. Удобно подходит для продавцов, аналитиков и агентств.

---

## Как работает скрипт

- В **8:00 по Москве** (можно изменить) запускается выполнение
- В указанной папке Google Drive **фильтруются таблицы по ключевому слову**
- С каждой таблицей выполняется:
  1. Обновление листа **"оборачиваемость"**
  2. Копирование данных в сводную таблицу
  3. Обновление листа **"РНП"**
- Все сводные листы собираются в **общую таблицу**

> Данные собираются за прошедший день (00:00:00 – 23:59:59), остатки — только текущие

---

## Структура таблиц

### Лист "Оборачиваемость"
- Артикулы
- Остатки по складам
- Продажи за день, месяц
- Средние продажи за 3, 7, 21 день
- Сравнение с предыдущим месяцем (вставка через день)

### Лист "РНП"
- Рейтинг, маржа, заказы, средний чек
- Трафик, корзины, клики, показы
- Результаты рекламы, CTR, DRR, конверсии
- Остатки FBO, в пути, артикулы
- Авто-добавление столбцов при смене месяца

### Сводная таблица
- По каждому продавцу (лист)
- Общая сводка всех продавцов (1 лист)

---

## Необходимые данные

| Что нужно            | Где взять                                                                 |
|----------------------|---------------------------------------------------------------------------|
| ID папки             | В ссылке: `.../drive/folders/{GoogleDriveFolderId}`                       |
| ID сводной таблицы   | В ссылке: `.../spreadsheets/d/{SummarySpreadsheetId}/edit`                |
| Фильтр по имени      | Слово, с которого начинаются нужные таблицы                               |
| Google Credentials   | `google_credentials.json` — см. ниже                                      |
| WB API ключ          | В каждой таблице, в листе "оборачиваемость", ячейка `A1`                  |

---

## Как получить Google Credentials

1. Перейди в [Google Cloud Console](https://console.cloud.google.com/)
2. Создай проект
3. Включи **Google Sheets API** и **Google Drive API**
4. Создай сервисный аккаунт
5. Скачай ключ в формате `.json`

Сервисный аккаунт должен быть **добавлен как редактор** в папку и все таблицы.